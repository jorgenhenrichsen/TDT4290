
{% extends 'base.html' %}

{% block head %}
        <link rel="stylesheet" href="http://code.jquery.com/ui/1.8.18/themes/base/jquery-ui.css" type="text/css" media="all" />
        <link rel="stylesheet" type="text/css" href="/static/css/search.css">
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript">
        </script> <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js" type="text/javascript"></script>
        <script src="/static/js/jquery.tablesorter.js" type="text/javascript"></script>

        <script type="text/javascript">


        $(document).ready(function () {
           $("#result-table").tablesorter();
        });

        var selectedLifter;

        $(function() {
          $("#query-text").autocomplete({
              source: "/search/lifter/",
              minLength: 2,
              select: function (event, ui) {
                  var id = ui.item.id
                  console.log("Selected " + ui.item.label, "ID: " + id);
                  selectedLifter = id;
              }
          });
        });

        function submitForm() {
            var form = document.getElementById("search-form");
            var lifterId = document.getElementById("lifter-id");
            lifterId.value = selectedLifter;
            form.submit();
        }

        </script>
{%  endblock %}


{% block content %}

    <section class="search-section">

        <h1>Søk etter resultater</h1>

        <form class="query-form" id="search-form" role="search" action="/search/">
            <div class="ui-widget">
                <input type="text" id="query-text" class="query-text-input" placeholder="Navn..." name="query_text">

                <select class="search-selector" name="club_id">
                    <option disabled selected value="">Velg klubb</option>
                    {% for club in clubs %}
                        <option value={{ club.pk }}>{{ club.clubName }}</option>
                    {% endfor %}
                </select>

                <select class="search-selector">
                    <option disabled selected value="">Velg vektklasse</option>
                </select>

                <select class="search-selector">
                    <option disabled selected>Velg kategori</option>
                </select>

                <input type="hidden" value="" id="lifter-id" name="lifter_id">

            </div>
         </form>

        <button class="search-button" onclick="submitForm()">Søk</button>

    </section>


    <section class="search-results-section">
            <table class="tablesorter" id="result-table">
                <thead>

                    <tr>
                        <th>Utøver</th>
                        <th>Klubb</th>
                        <th>Kategori</th>
                        <th>Arrangør</th>
                        <th>Rykk</th>
                        <th>Støt</th>
                        <th>Total</th>
                        <th>Poeng</th>
                        <th>Veteranpoeng</th>
                    </tr>

                </thead>


                {% for result in results %}

                <tr class="result-element">

                    <th>{{ result.lifter.first_name }} {{ result.lifter.last_name }}</th>
                    <th>{{ result.lifter.club.clubName }}</th>
                    <th>Kategori</th>
                    <th>Arrangør</th>
                    <th>{{ result.get_best_snatch }}</th>
                    <th>{{ result.get_bets_clean_and_jerk }}</th>
                    <th>{{ result.total }}</th>
                    <th>{{ result.points }}</th>
                    <th>{{ result.points_veteran }}</th>

                </tr>

                {% endfor %}

            </table>


        </section>

{% endblock %}